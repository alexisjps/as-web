<div class="container">
  <div class="row">
    <div class="col-md-8 offset-md-2">
      <h1 class="text-center">DNS Lookup</h1>
      <%= form_with url: dnslookupslookup_path, method: :get, local: true, class: 'mt-4' do %>
        <div class="input-group">
          <%= text_field_tag :domain, params[:domain], class: 'form-control', placeholder: 'Entrez un nom de domaine (ex: example.com)' %>
          <button class="btn btn-primary" type="submit">Rechercher</button>
        </div>
      <% end %>

      <% if @results %>
        <table class="table table-bordered table-striped mt-5">
          <thead>
            <tr>
              <th>Type</th>
              <th>Enregistrement</th>
            </tr>
          </thead>
          <tbody>
            <% @results.each do |record_type, records| %>
              <% if records %>
                <% records.each do |record| %>
                  <tr>
                    <td><%= record_type %></td>
                    <td>
                      <% if record_type == 'MX' %>
                        <%= "#{record.preference} #{record.exchange}" %>
                      <% elsif record_type == 'CNAME' %>
                        <%= record.domainname %>
                        <% if record.domainname.to_s.include?('herokudns') %>
                          <i class="bi bi-check-circle text-success" data-bs-toggle="tooltip" data-bs-placement="top" title="Bien configurÃ© pour Heroku"></i>
                        <% end %>
                      <% elsif record_type == 'TXT' %>
                        <%= record.strings.join(' ') %>
                      <% elsif record_type == 'A' || record_type == 'AAAA' %>
                        <%= record.address %>
                      <% elsif record_type == 'NS' %>
                        <%= record.domainname %>
                      <% end %>
                    </td>
                  </tr>
                <% end %>
              <% end %>
            <% end %>
          </tbody>
        </table>
      <% end %>
    </div>
  </div>
</div>
